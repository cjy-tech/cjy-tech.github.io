![image](https://user-images.githubusercontent.com/33619494/187594488-87101a71-5b8f-4a50-a805-64256e159a9c.png)


## VM과 Docker Container 차이점은?

### Container의 장점

#### *작다*
vm은 hypervisor가 hardware를 가상화 한다. 그리고 그 위에 Guest OS가 올라가게 된다.
container는 도커 엔진위에 application에 실행에 필요한 바이너리만 올라간다. 그 외 커널 부분은 호스트의 커널을 공유한다. 격리는 linux namespace를 통해 개념적으로만 수행하게 되고, 만약 호스트 커널과 container의 커널이 다르다면, 다른 부분만큼만 패키징된다.

#### *빠르다*
먼저, 당연히 vm, container 모두 host 머신보다는 느리다. 하지만 container와 vm을 비교하자면 container가 더 빠르다. 몇몇 원인들이 있겠지만, 가장 단순하게 보면, vm은 IO가 발생하는 통로가 container보다 많다.
vm은 host os에서 거의 완벽히 분리된 형태로 운영이 되어, vm이 처리한 IO를 결국 host os의 커널이 다시 받아 자신의 드라이버에 맞게 처리해야 한다. 이 부분에서 vm은 병목이 발생하게 된다.
반면, container는 host OS의 커널을 공유하기 때문에 들어온 IO가 쉽게 처리될 수 있다.
결국 vm이 container보다 더 많은 커널 처리가 들어가야 되니 성능이 좀 더 느리다.

얼핏 생각해본다면, 도커의 이미지에도 결국 OS가 포함되어 있기 때문에, vm과 결국 같은 것이 아니냐라고 생각할 수 있지만, 위의 이유(host OS 커널 공유)때문에 vm보다 평균적으로 더 빠르다라고 볼 수 있다.

### vm의 장점

#### *보안*
위에서 말한 것 처럼, container는 host와 커널을 공유한다. 이러한 점이 보안상 이슈가 될 수 있는데, 왜냐하면 container 하나가 뚫린다면 곧바로 host 커널에도 영향이 갈 수 있다는 말이기 때문이다. host 커널이 아니더라도, 커널을 공유하기 때문에 다른 container에도 영향이 미칠 수 있다.
반면, vm은 host os와 공유되는 것이 없이 거의 완벽히 격리되므로 보안상 vm이 더 안전하다고 볼 수 있다.

### 도커컨테이너 특징

위의 vm과 container의 차이점을 알아본 내용을 도커 컨테이너의 특징으로 정리해보면, 아래와 같이 정리할 수 있다.

* 추가적인 OS를 설치해 가상화하는 방법은 성능 문제가 있어, 이를 개선하기 위해 프로세스를 격리하는 방식이 등장
* 단순히 프로세스를 격리시키므로 가볍고 빠르게 동작한다. 또 CPU, 메모리는 딱 프로세스가 필요한 만큼만 추가로 사용하고 성능적으로 거의 손실이 없다.
* 하나의 서버에 여러개 컨테이너를 실행하면 서로 영향을 주지 않음. 마치 가벼운 VM을 사용하는 느낌이다. 또 실행중인 컨테이너에 접속해 명령어를 입력할 수 있고, apt-get 이나 yum으로 패키지를 설치할 수 있으며 사용자도 추가하고, 여러개의 프로세스를 백그라운드로 실행할 수도 있다.
* CPU나 메모리 사용량을 제한할 수 있고, 호스트 특정 포트와 연결하거나 호스트 특정 디렉토리를 내부 디렉토리인 것처럼 사용할 수도 있다.
* 새로운 컨테이너를 만드는데 걸리는 시간 1-2초로 가상머신과 비교할 수 없이 빠르다.